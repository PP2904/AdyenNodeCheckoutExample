 <!-- Country dropdown with flags and associated currencies -->
  <div class="country-select">
    <label for="country-dropdown">Choose your country:</label>
    <select id="country-dropdown" onchange="setCountry(this)">
      <option value="US" data-locale="en_US" data-currency="USD">ðŸ‡ºðŸ‡¸ United States</option>
      <option value="NL" data-locale="nl_NL" data-currency="EUR">ðŸ‡³ðŸ‡± Netherlands</option>
      <option value="CH" data-locale="de_CH" data-currency="CHF">ðŸ‡¨ðŸ‡­ Switzerland</option>
      <option value="FR" data-locale="fr_FR" data-currency="EUR">ðŸ‡«ðŸ‡· France</option>
      <option value="DE" data-locale="de_DE" data-currency="EUR">ðŸ‡©ðŸ‡ª Germany</option>
      <option value="IT" data-locale="it_IT" data-currency="EUR">ðŸ‡®ðŸ‡¹ Italy</option>
    </select>
  </div>

<!-- Container for the Drop-in -->
<div id="dropin-container"></div>

<script>
  document.getElementById("country-select").addEventListener("change", function () {
    const selectedCountry = this.value;
    const selectedCurrency = this.options[this.selectedIndex].getAttribute("data-currency");

    // Fetch session with selected country and currency
    fetch("/api/sessions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        country: selectedCountry,
        currency: selectedCurrency,
      }),
    })
      .then((response) => response.json())
      .then((session) => {
        // Initialize Adyen Drop-in
        const configuration = {
          clientKey: "YOUR_ADYEN_CLIENT_KEY", // Replace with your actual Adyen client key
          locale: "en_US",
          environment: "test",
          session: session,
          showStoredPaymentMethods: false,
          onPaymentCompleted: (result, component) => {
            console.log("Payment completed:", result);
          },
          onError: (error, component) => {
            console.error("Error:", error);
          },
        };

        const checkout = new AdyenCheckout(configuration);
        checkout.create("dropin").mount("#dropin-container");
      })
      .catch((error) => console.error("Error fetching session:", error));
  });
</script>


<div class="main-container">
  <div class="info">
    <h1>Select a demo</h1>
    <p>Click to view an interactive example of a PCI-compliant UI integration for online payments.</p>
    <p>To add missing payment methods, refer to the <a href="https://docs.adyen.com/payment-methods#add-payment-methods-to-your-account">documentation</a>.</p>
  </div>

  <!-- Country dropdown with flags and associated currencies -->
  <div class="country-select">
    <label for="country-dropdown">Choose your country:</label>
    <select id="country-dropdown" onchange="setCountry(this)">
      <option value="US" data-locale="en_US" data-currency="USD">ðŸ‡ºðŸ‡¸ United States</option>
      <option value="NL" data-locale="nl_NL" data-currency="EUR">ðŸ‡³ðŸ‡± Netherlands</option>
      <option value="CH" data-locale="de_CH" data-currency="CHF">ðŸ‡¨ðŸ‡­ Switzerland</option>
      <option value="FR" data-locale="fr_FR" data-currency="EUR">ðŸ‡«ðŸ‡· France</option>
      <option value="DE" data-locale="de_DE" data-currency="EUR">ðŸ‡©ðŸ‡ª Germany</option>
      <option value="IT" data-locale="it_IT" data-currency="EUR">ðŸ‡®ðŸ‡¹ Italy</option>
    </select>
  </div>

  <!-- Store the selected country code, locale, and currency for use in adyenImplementation.js -->
  <input type="hidden" id="selected-country-code">
  <input type="hidden" id="selected-locale">
  <input type="hidden" id="selected-currency">

  <ul class="integration-list">
    <li class="integration-list-item">
      <a href="/preview?type=dropin" class="integration-list-item-link">
        <p class="integration-list-item-title">Drop-in</p>
      </a>
    </li>
    <li class="integration-list-item">
      <a href="/preview?type=card" class="integration-list-item-link">
        <p class="integration-list-item-title">Card</p>
      </a>
    </li>
    <li class="integration-list-item">
      <a href="/preview?type=paypal" class="integration-list-item-link">
        <p class="integration-list-item-title">PayPal</p>
      </a>
    </li>
    <li class="integration-list-item">
      <a href="/preview?type=multiple" class="integration-list-item-link">
        <p class="integration-list-item-title">Multiple Components</p>
      </a>
    </li>
    <li class="integration-list-item">
      <a href="/preview?type=twint" class="integration-list-item-link">
        <p class="integration-list-item-title">TWINT</p>
      </a>
    </li>
  </ul>
</div>

<script>
  window.onload = function () {
    const savedCountry = localStorage.getItem("selectedCountry") || "US";
    const savedLocale = localStorage.getItem("selectedLocale") || "en_US";
    const savedCurrency = localStorage.getItem("selectedCurrency") || "USD";

    document.getElementById("country-dropdown").value = savedCountry;
    document.getElementById("selected-country-code").value = savedCountry;
    document.getElementById("selected-locale").value = savedLocale;
    document.getElementById("selected-currency").value = savedCurrency;

    setCountry(document.getElementById("country-dropdown"));
  };

  function setCountry(selectElement) {
    const selectedOption = selectElement.options[selectElement.selectedIndex];
    const countryCode = selectedOption.value;
    const locale = selectedOption.getAttribute("data-locale");
    const currency = selectedOption.getAttribute("data-currency");

    document.getElementById("selected-country-code").value = countryCode;
    document.getElementById("selected-locale").value = locale;
    document.getElementById("selected-currency").value = currency;

    localStorage.setItem("selectedCountry", countryCode);
    localStorage.setItem("selectedLocale", locale);
    localStorage.setItem("selectedCurrency", currency);
  }
</script>